<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>Login - MAINTAIN HEALTH</title>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        /* Style tambahan khusus halaman login */
        .login-container {
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .login-box {
            background: white;
            border-radius: 20px;
            padding: 40px 30px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            animation: slideUp 0.5s ease-out;
        }
        
        .logo {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .logo h1 {
            color: #667eea;
            font-size: 28px;
            margin-bottom: 5px;
        }
        
        .logo p {
            color: #666;
            font-size: 14px;
        }
        
        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }
        
        .tab-btn {
            flex: 1;
            padding: 12px;
            border: none;
            background: none;
            font-size: 16px;
            font-weight: 600;
            color: #999;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 10px;
        }
        
        .tab-btn.active {
            color: #667eea;
            background: #f0f3ff;
        }
        
        .login-form {
            display: none;
        }
        
        .login-form.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
            font-size: 14px;
        }
        
        .input-group {
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .input-icon {
            position: absolute;
            left: 15px;
            color: #999;
            font-size: 18px;
        }
        
        .input-field {
            width: 100%;
            padding: 15px 15px 15px 50px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
            box-sizing: border-box;
        }
        
        .input-field:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .input-field.error {
            border-color: #f44336;
        }
        
        .password-toggle {
            position: absolute;
            right: 15px;
            color: #999;
            cursor: pointer;
            font-size: 18px;
        }
        
        .remember-forgot {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .remember {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #666;
            font-size: 14px;
        }
        
        .remember input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        .forgot-link {
            color: #667eea;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
        }
        
        .forgot-link:hover {
            text-decoration: underline;
        }
        
        .btn-login {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            margin-bottom: 20px;
        }
        
        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .btn-login:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .register-link {
            text-align: center;
            color: #666;
            font-size: 14px;
        }
        
        .register-link a {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
        }
        
        .register-link a:hover {
            text-decoration: underline;
        }
        
        /* OTP Section */
        .otp-section {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            animation: slideDown 0.5s;
        }
        
        .otp-input {
            text-align: center;
            letter-spacing: 8px;
            font-size: 24px;
            font-weight: bold;
            padding: 15px;
        }
        
        .timer {
            text-align: center;
            color: #f44336;
            font-size: 14px;
            margin: 10px 0;
        }
        
        .resend-btn {
            background: none;
            border: none;
            color: #667eea;
            text-decoration: underline;
            cursor: pointer;
            font-size: 14px;
            width: 100%;
            text-align: center;
        }
        
        .resend-btn:disabled {
            color: #999;
            cursor: not-allowed;
        }
        
        .error-message {
            color: #f44336;
            font-size: 13px;
            margin-top: 5px;
            display: none;
        }
        
        .error-message.show {
            display: block;
        }
        
        .success-message {
            color: #4CAF50;
            font-size: 13px;
            margin-top: 5px;
            display: none;
        }
        
        .success-message.show {
            display: block;
        }
        
        .back-to-login {
            text-align: center;
            margin-top: 20px;
        }
        
        .back-btn {
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            font-size: 14px;
        }
        
        .back-btn:hover {
            color: #667eea;
        }
        
        /* Animations */
        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        @keyframes slideDown {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        .shake {
            animation: shake 0.5s;
        }
        
        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Responsive */
        @media (max-width: 480px) {
            .login-box {
                padding: 30px 20px;
            }
            
            .logo h1 {
                font-size: 24px;
            }
            
            .tab-btn {
                font-size: 14px;
                padding: 10px;
            }
            
            .input-field {
                padding: 12px 12px 12px 45px;
                font-size: 14px;
            }
            
            .btn-login {
                padding: 14px;
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="login-container">
        <div class="login-box">
            <!-- Logo -->
            <div class="logo">
                <h1>MAINTAIN HEALTH</h1>
                <p>by Salsabillah Kirana Rahmadani</p>
            </div>
            
            <!-- Tab Buttons -->
            <div class="tab-buttons">
                <button class="tab-btn active" onclick="switchTab('email')" id="tab-email">üìß Email</button>
                <button class="tab-btn" onclick="switchTab('phone')" id="tab-phone">üì± No. HP</button>
                <button class="tab-btn" onclick="switchTab('forgot')" id="tab-forgot">üîê Lupa</button>
            </div>
            
            <!-- FORM LOGIN EMAIL -->
            <div id="email-form" class="login-form active">
                <div class="form-group">
                    <label>Alamat Email</label>
                    <div class="input-group">
                        <span class="input-icon">üìß</span>
                        <input type="email" id="email" class="input-field" placeholder="contoh@email.com">
                    </div>
                    <div id="email-error" class="error-message">Email tidak valid</div>
                </div>
                
                <div class="form-group">
                    <label>Password</label>
                    <div class="input-group">
                        <span class="input-icon">üîí</span>
                        <input type="password" id="password" class="input-field" placeholder="Minimal 6 karakter">
                        <span class="password-toggle" onclick="togglePassword('password')">üëÅÔ∏è</span>
                    </div>
                    <div id="password-error" class="error-message">Password harus minimal 6 karakter</div>
                </div>
                
                <div class="remember-forgot">
                    <label class="remember">
                        <input type="checkbox" id="remember-email"> Ingat saya
                    </label>
                    <a href="#" class="forgot-link" onclick="switchTab('forgot')">Lupa password?</a>
                </div>
                
                <button class="btn-login" onclick="loginWithEmail()" id="btn-email-login">Masuk dengan Email</button>
            </div>
            
            <!-- FORM LOGIN NO HP -->
            <div id="phone-form" class="login-form">
                <div class="form-group">
                    <label>Nomor Telepon</label>
                    <div class="input-group">
                        <span class="input-icon">üì±</span>
                        <input type="tel" id="phone" class="input-field" placeholder="081234567890">
                    </div>
                    <div id="phone-error" class="error-message">Nomor telepon tidak valid</div>
                </div>
                
                <div class="form-group">
                    <label>Password</label>
                    <div class="input-group">
                        <span class="input-icon">üîí</span>
                        <input type="password" id="phone-password" class="input-field" placeholder="Minimal 6 karakter">
                        <span class="password-toggle" onclick="togglePassword('phone-password')">üëÅÔ∏è</span>
                    </div>
                    <div id="phone-password-error" class="error-message">Password harus minimal 6 karakter</div>
                </div>
                
                <div class="remember-forgot">
                    <label class="remember">
                        <input type="checkbox" id="remember-phone"> Ingat saya
                    </label>
                    <a href="#" class="forgot-link" onclick="switchTab('forgot')">Lupa password?</a>
                </div>
                
                <button class="btn-login" onclick="loginWithPhone()" id="btn-phone-login">Masuk dengan No. HP</button>
            </div>
            
            <!-- FORM LUPA PASSWORD -->
            <div id="forgot-form" class="login-form">
                <div class="form-group">
                    <label>Email atau Nomor Telepon</label>
                    <div class="input-group">
                        <span class="input-icon">üìß/üì±</span>
                        <input type="text" id="forgot-input" class="input-field" placeholder="Email atau No. HP">
                    </div>
                    <div id="forgot-error" class="error-message">Field ini harus diisi</div>
                </div>
                
                <button class="btn-login" onclick="sendOTP()" id="btn-send-otp">Kirim Kode OTP</button>
                
                <!-- OTP Section (hidden by default) -->
                <div id="otp-section" class="otp-section" style="display: none;">
                    <div class="form-group">
                        <label>Masukkan Kode OTP</label>
                        <input type="text" id="otp-input" class="input-field otp-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="6">
                        <div id="otp-error" class="error-message">Kode OTP salah</div>
                    </div>
                    
                    <div class="timer" id="timer">02:00</div>
                    
                    <button class="btn-login" onclick="verifyOTP()" id="btn-verify-otp">Verifikasi OTP</button>
                    
                    <button class="resend-btn" onclick="resendOTP()" id="btn-resend" disabled>Kirim Ulang OTP</button>
                    
                    <div class="back-to-login">
                        <button class="back-btn" onclick="switchTab('email')">‚Üê Kembali ke Login</button>
                    </div>
                </div>
            </div>
            
            <!-- Register Link -->
            <div class="register-link">
                Belum punya akun? <a href="#" onclick="showRegister()">Daftar sekarang</a>
            </div>
            
            <!-- Loading Overlay -->
            <div id="loading" style="display: none; text-align: center; margin-top: 20px;">
                <div class="spinner"></div>
                <span>Memproses...</span>
            </div>
        </div>
    </div>
    
    <!-- Notification -->
    <div id="notification" class="notification" style="display: none;"></div>
    
    <script>
        // State
        let otpTimer;
        let timeLeft = 120; // 2 minutes in seconds
        let currentOTP = '';
        
        // Switch between tabs
        function switchTab(tab) {
            // Update tab buttons
            document.getElementById('tab-email').classList.remove('active');
            document.getElementById('tab-phone').classList.remove('active');
            document.getElementById('tab-forgot').classList.remove('active');
            
            // Hide all forms
            document.getElementById('email-form').classList.remove('active');
            document.getElementById('phone-form').classList.remove('active');
            document.getElementById('forgot-form').classList.remove('active');
            
            // Show selected form
            if (tab === 'email') {
                document.getElementById('tab-email').classList.add('active');
                document.getElementById('email-form').classList.add('active');
            } else if (tab === 'phone') {
                document.getElementById('tab-phone').classList.add('active');
                document.getElementById('phone-form').classList.add('active');
            } else if (tab === 'forgot') {
                document.getElementById('tab-forgot').classList.add('active');
                document.getElementById('forgot-form').classList.add('active');
                // Hide OTP section when switching to forgot
                document.getElementById('otp-section').style.display = 'none';
            }
        }
        
        // Toggle password visibility
        function togglePassword(fieldId) {
            const field = document.getElementById(fieldId);
            if (field.type === 'password') {
                field.type = 'text';
            } else {
                field.type = 'password';
            }
        }
        
        // Validate email
        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }
        
        // Validate phone number (Indonesia format)
        function validatePhone(phone) {
            const re = /^(08|62|628)[0-9]{8,12}$/;
            return re.test(phone);
        }
        
        // Show error
        function showError(elementId, message) {
            const errorElement = document.getElementById(elementId);
            errorElement.textContent = message;
            errorElement.classList.add('show');
            
            // Add shake animation to input
            const input = errorElement.previousElementSibling.querySelector('.input-field');
            if (input) {
                input.classList.add('shake');
                setTimeout(() => {
                    input.classList.remove('shake');
                }, 500);
            }
        }
        
        // Hide error
        function hideError(elementId) {
            document.getElementById(elementId).classList.remove('show');
        }
        
        // Show notification
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }
        
        // Show loading
        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }
        
        // Login with email
        function loginWithEmail() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            // Reset errors
            hideError('email-error');
            hideError('password-error');
            
            let isValid = true;
            
            // Validate email
            if (!email) {
                showError('email-error', 'Email harus diisi');
                isValid = false;
            } else if (!validateEmail(email)) {
                showError('email-error', 'Format email tidak valid');
                isValid = false;
            }
            
            // Validate password
            if (!password) {
                showError('password-error', 'Password harus diisi');
                isValid = false;
            } else if (password.length < 6) {
                showError('password-error', 'Password minimal 6 karakter');
                isValid = false;
            }
            
            if (isValid) {
                showLoading(true);
                
                // Simulate login process
                setTimeout(() => {
                    showLoading(false);
                    
                    // Save login status
                    const userData = {
                        email: email,
                        isLoggedIn: true,
                        loginMethod: 'email',
                        lastLogin: new Date().toISOString()
                    };
                    localStorage.setItem('userData', JSON.stringify(userData));
                    
                    showNotification('Login berhasil! Selamat datang di MAINTAIN HEALTH', 'success');
                    
                    // Redirect to dashboard
                    setTimeout(() => {
                        window.location.href = 'dashboard.html';
                    }, 1500);
                }, 2000);
            }
        }
        
        // Login with phone
        function loginWithPhone() {
            const phone = document.getElementById('phone').value;
            const password = document.getElementById('phone-password').value;
            
            // Reset errors
            hideError('phone-error');
            hideError('phone-password-error');
            
            let isValid = true;
            
            // Validate phone
            if (!phone) {
                showError('phone-error', 'Nomor telepon harus diisi');
                isValid = false;
            } else if (!validatePhone(phone)) {
                showError('phone-error', 'Format nomor telepon tidak valid');
                isValid = false;
            }
            
            // Validate password
            if (!password) {
                showError('phone-password-error', 'Password harus diisi');
                isValid = false;
            } else if (password.length < 6) {
                showError('phone-password-error', 'Password minimal 6 karakter');
                isValid = false;
            }
            
            if (isValid) {
                showLoading(true);
                
                // Simulate login process
                setTimeout(() => {
                    showLoading(false);
                    
                    // Save login status
                    const userData = {
                        phone: phone,
                        isLoggedIn: true,
                        loginMethod: 'phone',
                        lastLogin: new Date().toISOString()
                    };
                    localStorage.setItem('userData', JSON.stringify(userData));
                    
                    showNotification('Login berhasil! Selamat datang di MAINTAIN HEALTH', 'success');
                    
                    // Redirect to dashboard
                    setTimeout(() => {
                        window.location.href = 'dashboard.html';
                    }, 1500);
                }, 2000);
            }
        }
        
        // Send OTP
        function sendOTP() {
            const input = document.getElementById('forgot-input').value;
            
            hideError('forgot-error');
            
            if (!input) {
                showError('forgot-error', 'Email atau nomor telepon harus diisi');
                return;
            }
            
            showLoading(true);
            
            // Simulate sending OTP
            setTimeout(() => {
                showLoading(false);
                
                // Generate random OTP (6 digits)
                currentOTP = Math.floor(100000 + Math.random() * 900000).toString();
                
                // Show OTP section
                document.getElementById('otp-section').style.display = 'block';
                document.getElementById('btn-send-otp').style.display = 'none';
                
                // Start timer
                startOTPTimer();
                
                showNotification(`Kode OTP telah dikirim ke ${input}`, 'success');
                
                // For demo purposes, show OTP in console
                console.log('OTP Anda:', currentOTP);
                
                // Auto-fill OTP for demo (remove in production)
                document.getElementById('otp-input').value = currentOTP;
            }, 2000);
        }
        
        // Start OTP timer
        function startOTPTimer() {
            timeLeft = 120;
            updateTimer();
            
            otpTimer = setInterval(() => {
                timeLeft--;
                updateTimer();
                
                if (timeLeft <= 0) {
                    clearInterval(otpTimer);
                    document.getElementById('btn-resend').disabled = false;
                    document.getElementById('timer').textContent = '00:00';
                }
            }, 1000);
        }
        
        // Update timer display
        function updateTimer() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('timer').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // Verify OTP
        function verifyOTP() {
            const enteredOTP = document.getElementById('otp-input').value;
            
            hideError('otp-error');
            
            if (!enteredOTP) {
                showError('otp-error', 'Kode OTP harus diisi');
                return;
            }
            
            if (enteredOTP.length !== 6) {
                showError('otp-error', 'Kode OTP harus 6 digit');
                return;
            }
            
            if (enteredOTP !== currentOTP) {
                showError('otp-error', 'Kode OTP salah');
                return;
            }
            
            showLoading(true);
            
            // Simulate verification
            setTimeout(() => {
                showLoading(false);
                
                clearInterval(otpTimer);
                showNotification('Verifikasi berhasil! Silakan reset password Anda', 'success');
                
                // Here you would show reset password form
                // For now, redirect to login
                setTimeout(() => {
                    switchTab('email');
                    document.getElementById('otp-section').style.display = 'none';
                    document.getElementById('btn-send-otp').style.display = 'block';
                }, 2000);
            }, 1500);
        }
        
        // Resend OTP
        function resendOTP() {
            document.getElementById('btn-resend').disabled = true;
            
            // Generate new OTP
            currentOTP = Math.floor(100000 + Math.random() * 900000).toString();
            
            // Reset timer
            clearInterval(otpTimer);
            startOTPTimer();
            
            showNotification('Kode OTP telah dikirim ulang', 'success');
            console.log('OTP baru:', currentOTP);
            
            // Auto-fill for demo
            document.getElementById('otp-input').value = currentOTP;
        }
        
        // Show register (for demo)
        function showRegister() {
            showNotification('Fitur pendaftaran akan segera hadir!', 'info');
        }
        
        // Check if already logged in
        window.onload = function() {
            const userData = localStorage.getItem('userData');
            if (userData) {
                const user = JSON.parse(userData);
                if (user.isLoggedIn) {
                    // Auto redirect to dashboard
                    window.location.href = 'dashboard.html';
                }
            }
        };
        
        // Add enter key support
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const activeTab = document.querySelector('.tab-btn.active').id;
                if (activeTab === 'tab-email') {
                    loginWithEmail();
                } else if (activeTab === 'tab-phone') {
                    loginWithPhone();
                } else if (activeTab === 'tab-forgot') {
                    const otpVisible = document.getElementById('otp-section').style.display === 'block';
                    if (otpVisible) {
                        verifyOTP();
                    } else {
                        sendOTP();
                    }
                }
            }
        });
    </script>
</body>
</html>